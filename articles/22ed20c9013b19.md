---
title: "Neovim ã« GitHub Copilot ã‚’è¿½åŠ ã—ãŸ"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["githubcopilot", "neovim", "lua"]
published: true
---

# ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã¯ã€Neovim ã« GitHub Copilot ã‚’è¿½åŠ ã—ãŸã¨ãã«ç™ºç”Ÿã—ãŸå•é¡Œã‚’è§£æ¶ˆã—ãŸè¨˜äº‹ã§ã™ã€‚

# å¯¾è±¡èª­è€…

- Neovim ã« GitHub Copilot ã‚’å°å…¥ã—ãŸãŒã€ Tab ã§è£œå®Œã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã‚Šã€ä»–ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã®å½±éŸ¿ã§ã†ã¾ã GitHub Copilot ãŒå‹•ä½œã—ãªã‹ã£ãŸäºº
- Neovim ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ lua ã§æ›¸ã„ã¦ã„ã‚‹äºº

# æœ¬æ–‡

## å‰ææ¡ä»¶

- iTerm2ã€tmuxã€Neovim ã‚’åˆ©ç”¨
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†ã¯ [Packer](https://github.com/wbthomason/packer.nvim) ã‚’åˆ©ç”¨

## ç™ºç”Ÿã—ã¦ã„ãŸå•é¡Œ

- `If you'd rather use a key that isn't <Tab>, define an <expr> map that calls
copilot#Accept().` ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆä»¥å‰ã¯è¡¨ç¤ºã•ã‚Œã¦ã„ãŸã®ã§ã™ãŒã€2023/04/16 ç¾åœ¨ã¯ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„ã‹ã‚‚ï¼‰
- ã‚‚ã—ãã¯ã™ã§ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ `Tab` ã®å‹•ä½œãŒèµ°ã‚Šã€ GitHub Copilot ã®è£œå®ŒãŒå®Ÿè¡Œã•ã‚Œãªã„

## æœ€åˆã«çµè«–

- ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ãƒ•ãƒ©ã‚°ã‚’è¿½åŠ ã—ã€å¿…è¦ãªã‚­ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ã™ã‚Œã° OK

ä»¥ä¸‹ã‚’æ—¢å­˜ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¦ã€å•é¡ŒãŒè§£æ¶ˆã—ã¾ã—ãŸã€‚ã‚­ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°ã ã‘ Tab ä»¥å¤–ã«ã™ã‚Œã°ã„ã„ã¨æ€ã£ã¦ã„ãŸã®ã§ã™ãŒã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®ãƒ•ãƒ©ã‚°ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚

```lua:init.lua
--[[ Package manager ]]
return require("packer").startup(function()
  -- Package manager
  use("wbthomason/packer.nvim")

  ...

  -- GitHub Copilot
  use({
    "github/copilot.vim",
    config = function()
      vim.g.copilot_no_tab_map = true

      local keymap = vim.keymap.set
      -- https://github.com/orgs/community/discussions/29817#discussioncomment-4217615
      keymap(
        "i",
        "<C-g>",
        'copilot#Accept("<CR>")',
        { silent = true, expr = true, script = true, replace_keycodes = false }
      )
      keymap("i", "<C-j>", "<Plug>(copilot-next)")
      keymap("i", "<C-k>", "<Plug>(copilot-previous)")
      keymap("i", "<C-o>", "<Plug>(copilot-dismiss)")
      keymap("i", "<C-s>", "<Plug>(copilot-suggest)")
    end,
  })
end)
```

### ãƒ˜ãƒ«ãƒ—ã«ã¤ã„ã¦

ä¸Šè¨˜ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ `:h copilot#Accept()` ã«è¨˜è¼‰ã•ã‚Œã¦ã„ Vim script ã‚’ lua ã§æ›¸ãç›´ã—ãŸã‚‚ã®ã§ã™ã€‚

```txt:help copilot#Accept()
                                                *copilot#Accept()*
If you'd rather use a key that isn't <Tab>, define an <expr> map that calls
copilot#Accept().  Here's an example with CTRL-J:

        imap <silent><script><expr> <C-J> copilot#Accept("\<CR>")
        let g:copilot_no_tab_map = v:true

The argument to copilot#Accept() is the fallback for when no suggestion is
displayed.  In this example, a regular carriage return is used.  If no
fallback is desired, use an argument of "" (an empty string).
```

### ã¾ã‚Œã«è¬ã®æ–‡å­—ãŒæŒ¿å…¥ã•ã‚Œã‚‹

Copilot ã®è£œå®Œã¯åŠ¹ãã‚ˆã†ã«ãªã£ãŸã‚“ã§ã™ãŒã€ã¾ã‚Œã«ã‚µã‚¸ã‚§ã‚¹ãƒˆã‚’ç¢ºå®šã™ã‚‹ã¨åŒæ™‚ã« `<80>kD` ã¨ã„ã†æ–‡å­—åˆ—ãŒæŒ¿å…¥ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã—ãŸã€‚èª¿ã¹ãŸã¨ã“ã‚ã€åŒæ§˜ã®å•é¡ŒãŒ Discussions ã«ä¸ŠãŒã£ã¦ã„ã¾ã—ãŸã€‚
ä»¥ä¸‹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«ã€ `replace_keycodes = false` ã‚’è¨­å®šã™ã‚‹ã¨è§£æ¶ˆã—ã¾ã—ãŸ ğŸ™Œ

https://github.com/orgs/community/discussions/29817#discussioncomment-4217615

## è£œè¶³

ã¡ãªã¿ã«ç§ã® Neovim è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ init.lua ã® 1 ãƒ•ã‚¡ã‚¤ãƒ«ã§æ§‹æˆã—ã¦ã„ã¾ã™ã€‚
ä»¥å‰ã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åˆ†å‰²ã—ã¦ã„ãŸã®ã§ã™ãŒã€ keymapping ã‚„è¨­å®šã‚’è‰²ã€…ãŒã¨ã“ã‚ã‹ã‚‰æ¢ã™ã®ãŒå¤§å¤‰ã ã£ãŸã®ã§ã€ä»Šå›ã®è¨­å®šè¿½åŠ ã‚’æ©Ÿã«ã‚·ãƒ³ãƒ—ãƒ«ã«ã—ã¾ã—ãŸã€‚ã‚‚ã—ã‚ˆã‘ã‚Œã°ã”è¦§ãã ã•ã„ã€‚

https://github.com/gentamura/dotfiles/blob/main/.config/nvim/init.lua

ä¸Šè¨˜è¨­å®šã¯ä»¥ä¸‹ã®è¨˜äº‹ã‚’ã¨ã¦ã‚‚å‚è€ƒã«ã•ã›ã¦ã„ãŸã ã„ã¦ã„ã¾ã™ã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ ğŸ™

https://zenn.dev/takuya/articles/4472285edbc132
